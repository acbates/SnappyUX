let sux=(a=>{Array.prototype.rip=function(t){var r=[];for(let e=this.length-1;0<=e;e--)t(this[e])&&(r.push(this[e]),this.splice(e,1));return r.reverse()},Array.prototype.ripOne=function(t){for(let e=this.length-1;0<=e;e--){var r;if(t(this[e]))return r=this[e],this.splice(e,1),r}return null},HTMLElement.prototype.htmlChildAppend=function(e){var t=document.createElement("span");this.appendChild(t),t.outerHTML=e,sux._runMounts(this)},HTMLElement.prototype.htmlChildBefore=function(e,t){var r=document.createElement("span");this.insertBefore(r,t),r.outerHTML=e,sux._runMounts(this)};let e=1e3,n=new Map,s=new Map,o=new Map,i=(a._compMap=n,a._dataMap=s,a._drawMap=o,a._createdDuringDraw=[],a.isElement=e=>e instanceof Element||e instanceof HTMLDocument,a.genId=()=>(++e).toString(36),a.get=e=>n.get(e),a.element=e=>{if(e)return(e="string"==typeof e?n.get(e):e).element||(e.element=document.querySelector('[sux="'+e.suxId+'"]'))},a.jq=e=>{if(e)return(e="string"==typeof e?n.get(e):e)._jq||(window.$?e._jq=$(a.element(e)):void 0)},a.register=r=>{r.suxId||(r.suxId=a.genId()),n.has(r.suxId)||(n.set(r.suxId,r),o.set(r.draw,r),a.when(r),r.data?.length?r.data.forEach(t=>{if("object"==typeof t&&!(t instanceof Date)){let e=s.get(t);e?e.push(r):s.set(t,e=[r])}}):r.data=[],a._createdDuringDraw.push(r))},e=>{let t=null;var r=e.findIndex(e=>"function"==typeof e);if(-1<r){var n=e[r];e.splice(r,1),t={suxId:a.genId(),draw:n,data:e}}else{if((r=e.findIndex(e=>"object"==typeof e&&e.draw))<-1)throw new Error("No component or draw function was passed to the mount.");t=e[r],e.splice(r,1)}return t}),u=(a.mount=(...e)=>{var t=e.findIndex(e=>"string"==typeof e||a.isElement(e));let r=null;if(r=-1<t&&(r=e[t],e.splice(t,1),"string"==typeof r)?document.getElementById(r):r)return(t=r.getAttribute("sux"))&&(a.clearKids(r),t=n.get(t))&&(t.cleared?.(),a.youDontSay(t)),(t=i(e)).inny=!0,a._createdDuringDraw=[t],a.register(t),r.setAttribute("sux",t.suxId),e=r.innerHTML=t.draw(...t.data),a.settle(),e;throw new Error("Element or id of element required to mount.")},a.inject=(...e)=>{e=i(e);return e.outy=!0,a.register(e),e.draw(...e.data).replace(">",` sux="${e.suxId}">`)},a.settle=()=>{var e=[...a._createdDuringDraw];a._createdDuringDraw=[],e.forEach(e=>e.mounted?e.mounted():null)},a.repaint=t=>{if(t){"string"==typeof t&&(t=n.get(t)),a.clearKids(t);var r=a.element(t);if(r){a._createdDuringDraw=[];let e=t.draw(...t.data);t.outy?(e=e.replace(">",` sux="${t.suxId}">`),r.outerHTML=e,delete t.element):r.innerHTML=e,a._runMounts(r),a._createdDuringDraw.forEach(e=>e.mounted?e.mounted():null),a._createdDuringDraw=[],t.repainted?.()}else console.log("Element not found for "+t.suxId)}},a.touchData=t=>{var e;"object"!=typeof t||t instanceof Date||(e=s.get(t))&&e.forEach(e=>{e.dataTouched?e.dataTouched(t):a.repaint(e)})},a.replaceData=(r,n)=>{if(!("object"!=typeof r||r instanceof Date)){if("object"!=typeof n||n instanceof Date)throw new Error("Updating object to basic type is sadpanda.");var e=s.get(r);e&&e.forEach(e=>{var t;e.dataReplace?e.dataReplace(r,n):(-1<(t=e.data.indexOf(r))&&(e.data[t]=n),a.repaint(e))})}},a.clearKids=e=>{let t=null;if(!a.isElement(e))if(e?.suxId)t=a.element(e);else if(!(e="string"!=typeof e?e.suxId:e))return;(t=t||(a.isElement(e)?e:sux.element(e)))&&(a._clearMounts(t),t.querySelectorAll("[sux]").forEach(e=>{e=e.getAttribute("sux");let r=n.get(e);r&&(n.delete(e),o.delete(r.draw),a.youDontSay(r),r.data?.length&&r.data.forEach(e=>{var t,e=s.get(e);e&&-1<(t=e.indexOf(r))&&e.splice(t,1)}),r.cleared)&&r.cleared()}))},a.parent=e=>{if(!e)return null;let t=null,r=null;if(e.suxId?(e=(t=e).suxId,r=a.element(t)):"string"==typeof e&&(t=n.get(e)),t?.parent)return t?.parent;if(r||(a.isElement(e)?r=e:t?.element?r=t?.element:(r=document.querySelector('[sux="'+e+'"]'),t&&(t.element=r))),!(r=r||document.getElementById(e)))return null;for(r=r&&r.parentElement;r&&!r.getAttribute("sux");)r=r.parentElement;return r?((e=n.get(r.getAttribute("sux"))).element=r,t&&(t.parent=e),e):(console.log("PARENT NOT FOUND!"),null)},a.registerFactory=(e,t)=>{a.factories.set(e,(...e)=>{e=t(...e);return a.register(e),e})},a.getFactory=async(...e)=>{e=e.shift();return a.factories.has(e)?a.factories.get(e):a.loadPromises[e]||(a.loadPromises[e]=a._loadBundle(e))},{}),l=(a.event=e=>{var t=a.genId();return u[t]=e,"sux._event('"+t+"', this, event)"},a._event=(e,t,r)=>{u[e](t,r)},a.eventAttr=(e,t)=>" "+e+'="'+a.event(t)+'" ',a.onclick=e=>a.eventAttr("onclick",e),a.onchange=e=>a.eventAttr("onchange",e),a.onsubmit=e=>a.eventAttr("onsubmit",e),a.onmouseover=e=>a.eventAttr("onmouseover",e),a.onmouseout=e=>a.eventAttr("onmouseout",e),a._mountRefs={},a.mountFunc=e=>{var t=a.genId();return a._mountRefs[t]=e,' sux_mref="'+t+'" '},a._runMounts=e=>{(e=e||document).querySelectorAll("[sux_mref]").forEach(e=>{var t,r=e.getAttribute("sux_mref");a._mountRefs[r]&&(t=a._mountRefs[r],delete a._mountRefs[r],e.removeAttribute("sux_mref"),t(e))})},a._clearMounts=e=>{e&&e.querySelectorAll("[sux_mref]").forEach(e=>{var t=e.getAttribute("sux_mref");e.removeAttribute("sux_mref"),delete a._mountRefs[t]})},a.bind=o=>{if(o){let{event:t,draw:e,to:r,from:n}=o;o=e?e():a.mountFunc(r);let s=null;return"string"==typeof t?s=a.eventAttr(t,n):"object"==typeof t&&(s=Object.keys(t).map(e=>a.eventAttr(e,t[e])).join(" ")),o+s}},e=>1===e.length?e[0]:{prop:e.ripOne(e=>"string"==typeof e),obj:e.ripOne(e=>"object"==typeof e)});return a.bindValueChange=(...e)=>{if(e){let{prop:r,obj:n,to:s,from:t}=l(e);return a.bind({event:{onchange:e=>n[r]=t?t(e.value):e.value},to:e=>{let t=n[r];null!==(t=s?s(t):t)&&void 0!==t||(t=""),e.value=t}})}},a.bindCheckedChange=(...o)=>{if(o){let{prop:t,obj:r,to:e,from:n}=l(o),s=e?e(r[t]):r[t];return a.bind({event:"onchange",draw:()=>s?" checked ":"",from:e=>r[t]=n?n(e.checked):e.checked})}},a._sayWhenListeners={},a._whenObjects=new Map,a.when=(t,r)=>{if("string"==typeof t){let e=a._sayWhenListeners[t];(e=e||(a._sayWhenListeners[t]=[])).push(r)}else if("object"==typeof t){let r=t,n=[],e=null;(e="Object"===t.constructor?.name?Object.keys(t):Object.getOwnPropertyNames(Object.getPrototypeOf(t)))?.forEach(t=>{var e;4<t.length&&t.startsWith("when")&&(e={k:t,h:(...e)=>r[t](...e)},n.push(e),a.when(t.substring(4),e.h))}),n.length&&a._whenObjects.set(r,n)}},a.say=(e,...t)=>{(a._sayWhenListeners[e]||[]).forEach(e=>e(...t))},a.youDontSay=(e,t)=>{var r;e&&("string"==typeof e?(r=a._sayWhenListeners[e])&&(-1<(t=r.indexOf(t))&&r.splice(t,1),0===r.length)&&delete a._sayWhenListeners[e]:"object"==typeof e&&(t=a._whenObjects.get(e))&&(console.log("clearing handlers for object..."),t.forEach(e=>{a.youDontSay(e.k,e.h)}),a._whenObjects.delete(e)))},a.bodySnatch=(e,t)=>{for(var r in e)delete e[r];Object.assign(e,t),a.touchData(e)},a})({});(i=>{i.http=async(e,t,r,n)=>{n={method:t=t.toUpperCase(),headers:{"Content-Type":"application/json",...n}},r&&("GET"===t?e=(e.includes("?")?"&":"?")+new URLSearchParams(r).toString():n.body=JSON.stringify(r)),t=await fetch(e,n);if(t.ok)return t.json();throw new Error("HTTP error! status: "+t.status)},i.httpPost=async(...e)=>i.httpCall("POST",...e),i.httpGet=async(...e)=>i.httpCall("GET",...e),i.httpCall=async(e,t,r,n,s,o=e=>e)=>{let a=o({method:e,hostPath:t,path:r,params:n,headers:s});return(a=a&&a instanceof Promise?await a:a)&&(e=a.method,t=a.hostPath,r=a.path,n=a.params,s=a.headers),!t.endsWith("/")&&r&&(t+="/"),i.http(t+(r||""),e,n,s)},i.setupApi=t=>{Object.keys(t).forEach(e=>{let s=t[e];i[e]||(i[e]={get:async(e,t,r)=>sux.httpCall("GET",s.hostPath,e,t,r,s.preflight),post:async(e,t,r)=>sux.httpCall("POST",s.hostPath,e,t,r,s.preflight),call:async(e,t,r,n)=>sux.httpCall(e,s.hostPath,t,r,n,s.preflight)})})}})(sux||window.sux||{}),(s=>{s.bundles={},s.loadPromises={},s.factories=new Map,s.requestedResources=new Map,s.routes=[],s.siteLoader=null,s.loadScript=r=>{var e=s.requestedResources.get(r);return e||(e=new Promise(e=>{var t=document.createElement("script");t.onload=()=>setTimeout(()=>e(),50),t.type="text/javascript",t.src=r,document.head.appendChild(t)}),s.requestedResources.set(r,e)),e},s.loadStylesheet=e=>{for(var t of e=Array.isArray(e)?e:[e]){if(s.requestedResources.has(t))return;s.requestedResources.set(t,Promise.resolve());var r=document.createElement("link");r.rel="stylesheet",r.href=t,document.head.appendChild(r)}},s._loadBundle=async e=>{var t=s.bundles[e];t.style&&s.loadStylesheet(t.style);let r=t.source;if(Array.isArray(r)||(r=[r]),await Promise.allSettled(r.map(e=>s.loadScript(e))),s.factories.has(e))return s.factories.get(e);throw new Error("Bundle did not register a factory.")},s.loadBundles=r=>{s.bundles=r;let t=Object.keys(r);t.forEach(e=>{var t=r[e];t?.route&&(t.name=e,s.routes.push(t))}),s.siteLoader||(s.siteLoader=setTimeout(async()=>{for(var e of t)await s._loadBundle(e)},1e3))},s.go=e=>{document.location="#"+e},s.onclickGo=e=>s.eventAttr("onclick",()=>s.go(e)),s.onclickBack=()=>s.eventAttr("onclick",()=>history.back()),s.route=async r=>{(r="#"===(r=(r=r&&"object"==typeof r&&r.newURL?window.location.hash:r)||(window.location.hash||"#home")+"")[0]?r.substring(1):r).includes("?")&&(r=r.split("?")[0]);var e=s.routes.find(e=>{if(!Array.isArray(e.route))return e.route.test(r);for(var t of e.route)if(t.test(r))return!0;return!1});s.routes.forEach(e=>e.route.lastIndex=0),e?(window.isRetry&&delete window.isRetry,s.say("Routing",r,e)):window.isRetry?console.log("No route found for "+r+"!"):(history.back(),await new Promise(e=>setTimeout(e,50)),window.isRetry=!0,s.go(r))},s.parseQstring=e=>{if(!e){if(1===(e=(document.location+"").split("#")[0].split("?")).length)return{};e=e[1]}var t=e=>decodeURIComponent((e+"").replace(/\+/g,"%20")),r=e.split("&"),n={};for(let e=0;e<r.length;e++){var s=r[e].split("="),o=t(s[0]),a=t(s[1]||"");n[s[0]]?Array.isArray(n[o])?n[o].push(a):n[o]=[n[o],a]:n[o]=a}return n};class t{constructor({routeNames:e,loadingDraw:t,factoryRunner:r,showFunc:n,hideFunc:s}){this.namesToCareAbout={},(e||[]).forEach(e=>this.namesToCareAbout[e]=!0),this.loadingDraw=t,this.factoryRunner=r,this.showFunc=n,this.hideFunc=s,this.running=!1,this.stagedElements={}}mounted(){this.running=!0,s.repaint(this)}async show(n){if(this.namesToCareAbout[n]){let r=null;if(this.stagedElements[n])r=this.stagedElements[n];else{(r=document.createElement("div")).style.display="none",s.element(this).appendChild(r);let e=s.getFactory(n),t=(e instanceof Promise&&(e=await e),this.factoryRunner(n,e));t instanceof Promise&&(t=await t),s.mount(r,t),this.stagedElements[n]=r}this.currentElement&&(this.currentElement.style.display="none",this.hideFunc?.(s.get(this.currentElement.getAttribute("sux")))),r&&(r.style.display="block");n=s.get(r.getAttribute("sux"));n&&this.showFunc?.(n),this.currentElement=r}}draw(){return this.running?this.inny?"":`<div>${this.loadingDraw()}</div>`:this.loadingDraw()}}s.registerFactory("comp-swapper",e=>new t(e)),s.registerFactory("route-triggered-swapper",async e=>{return new class extends t{constructor(e){super(e),this.factoryRunner=async()=>{},this.showFunc=e=>{e._hasShown?e?.routeChanged?.(this.newHashPath,this.newRoute):e._hasShown=!0},this.hideFunc=e=>e?.routeHiding?.()}async whenRouting(r,n){this.factoryRunner=async(e,t)=>t(r,n),this.newHashPath=r,this.newRoute=n,this.show(n.name)}}(e)}),window.addEventListener("hashchange",s.route)})(sux||window.sux||{});